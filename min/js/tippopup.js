
var BUG_68135_NOCACHE=true;var MSG_TIP_CONTENT_APPENDSTYLESHEET="ass"+RandomString(6);var MSG_TIP_CONTENT_SETBODYINNERHTML="sbih"+RandomString(6);var MSG_TIP_CONTENT_SHOWSECTION="ss"+RandomString(6);var MSG_TIP_CONTENT_GETDIMENSIONS="gd"+RandomString(6);var MSG_TIP_CONTENT_SETLEVEL2SECTIONTAGNAMES="sl2stn"+RandomString(6);var MSG_TIP_CONTENT_ONCLICKANCHOR="oca"+RandomString(6);var MSG_TIP_CONTENT_ONSIZECHANGE="osc"+RandomString(6);var CLASS_BING_BUTTONAUDIOPLAYER="whywontchromeplaywavfileswithoutlockingupandwhyusewavanyway";var MEDIAWIKI_TOKEN_SPECIALSEARCH="Special:Search";var FORMAT_TIP_GOOGLELANGUAGEDETECT_CONFIDENT="Written in <b><<LANGUAGE>></b> (<<CONFIDENCE>>% confident)";var FORMAT_TIP_GOOGLETRANSLATE_FROMTO="Translated from <<FROM>> into <<TO>>";var FORMAT_TIP_GOOGLETRANSLATE_TO="Translated into <<TO>>";var FORMAT_TIP_PAGE="Page <b><<PAGE>></b>";var FORMAT_TIP_PAGEOFPAGES="Page <b><<PAGE>></b> of <<TOTALPAGES>>";var FORMAT_TIP_GOOGLEIMAGESEARCH_WIDTHHEIGHT_EXTENSION="<<WIDTH>> x <<HEIGHT>> - <<EXTENSION>>";var FORMAT_TIP_GOOGLEIMAGESEARCH_WIDTHHEIGHT="<<WIDTH>> x <<HEIGHT>>";var FORMAT_TIP_GOOGLETRANSLATE_URL='http://translate.google.com/translate?sl=<<SRCLANG>>&tl=<<DESTLANG>>&u=<<HREF>>'
var FORMAT_TIP_YAHOOWEB_SIZEDATE="<<SIZE>>k - <<DATE>>";var FORMAT_TIP_YAHOOSPELLING_CORRECT="No Alternate Spelling Suggestions";var FORMAT_TIP_YAHOOSPELLING_SUGGESTIONS="Suggested Alternatives<br/><<SUGGESTIONS>>";var FORMAT_TIP_MSTRANSLATE_TTS_SPOKENLANGUAGE="<<LANGUAGE>> Narrator";var FORMAT_TIP_GOOGLETRANSLATE_DEPRECATE="<i>Google will end their free translation service on December 1st 2011, and will be reducing the daily quota of translations upto that date. Please select <b>Bing Translate</b> from the Service menu (above) instead.</i>";var TOOLTIP_TIP_GOOGLELANGUAGEDETECT_RELIABLE="Reliable Detection";var TOOLTIP_TIP_GOOGLELANGUAGEDETECT_UNRELIABLE="Unreliable Detection";var TOOLTIP_TIP_MSTRANSLATE_TTS_PLAY="Play";var TOOLTIP_TIP_PAGE_PREVIOUS="Goto Previous Page of Results";var TOOLTIP_TIP_PAGE_NEXT="Goto Next Page of Results";var TOOLTIP_TIP_MEDIAWIKI_SECTION_UP="Goto Previous Section of the Page";var TOOLTIP_TIP_MEDIAWIKI_SECTION_DOWN="Goto Next Section of the Page";var TOOLTIP_TIP_MEDIAWIKI_SECTION="Page Section";var TOOLTIP_TIP_MEDIAWIKI_INFOBOX="Information Box";var TOOLTIP_TIP_MEDIAWIKI_INFOBOXCONTAINER="Information Box (click the corresponding icon in the toolbar to hide)";var TOOLTIP_TIP_TIP_BACK="Go Back One Tip";var TOOLTIP_TIP_TIP_FORWARD="Go Forward One Tip";var TOOLTIP_TIP_FLICKR_ORIGINAL="Original File";var TOOLTIP_TIP_TWITTER_RETWEETS="Number of recent retweets";var TOOLTIP_TIP_TWITTER_REFRESH="Refresh";var TOOLTIP_TIP_SELECTTEMPLATE="Service";var TOOLTIP_TIP_CLOSE="Close";var TOOLTIP_TIP_RESTRICTTOSITE="Limit scope of search to the current site";var TOOLTIP_TIP_TEMPLATEOPTIONS="Template Options";var TOOLTIP_TIP_TTS="Speak";var INNERHTML_TIP_RESTRICTTOSITE="Search Just This Site";var INNERHTML_TIP_GOOGLETRANSLATE_PAGE="Translate Page";var INNERHTML_TIP_FLICKR_SORT="Sort by";var INNERHTML_TIP_FLICKR_ORIGINALFILE="[file]";var INNERHTML_TIP_MEDIAWIKI_SECTION="Section";var INNERHTML_TIP_YAHOOWEB_RESTRICT="Restrict";var PADDING_HEIGHT_WITH_INFOBOXCONTAINER=10;var MAXCHARS_TIP_DISPLAYTITLE=16;var MAXCHARS_TIP_FLICKR_TITLE=16;var SECTIONNAME_TIP_MEDIAWIKI_INTRO="Summary";var CANVASWIDTH_TIP_ARROW=14;var CANVASHEIGHT_TIP_ARROW=14;var MINWIDTH_WORDWRAP_TIP=128;var BACKGROUNDCOLOUR_TIP="#ffc";var OPACITY_TIP_MOUSEOVER=1;var OPACITY_TIP_MOUSEOUT=0.95;var OPACITY_TIP_CLOSE_MOUSEOVER=1;var OPACITY_TIP_CLOSE_MOUSEOUT=0;var SHADOWWIDTH_TIP=3;var SHADOWHEIGHT_TIP=3;var SHADOWBLUR_TIP=8;var SHADOWCOLOUR_TIP="rgba(20,20,0,0.5)";var BORDERRADIUS_TIP=5;var BORDERWIDTH_TIP=2;var BORDERCOLOUR_TIP="black";var MAXHEIGHT_NOTICEBARS_TIP="20em";var BASEZINDEX_TIP=1000000+1000;var HIDE_WHILST_CALCULATING_IFRAME_SIZE=true;var arrTipPopupTemplates=null;var mouseActivateTipPopup=null;var buttonStatusTipPopupNoticeBar={};var useWordUnderCursor_TipPopup;function DoTipPopup(source,templateId){if(source.firstNode){if(source.firstNode.SimpleHighlight.divTipPopup&&source.togglePopup==true){RemoveTipPopup(source.firstNode.SimpleHighlight.divTipPopup);return;}}
if(templateId==null){for(var x in arrTipPopupTemplates){if(arrTipPopupTemplates[x].default==true){templateId=arrTipPopupTemplates[x].id;break;}}
if(templateId==null){for(var p in _arrTipPopupMasterTemplates){if(_arrTipPopupMasterTemplates[p].default==true){templateId=_arrTipPopupMasterTemplates[p].id;break;}}
if(templateId==null){for(var p in _arrTipPopupMasterTemplates){if(_arrTipPopupMasterTemplates[p].id!=null){templateId=_arrTipPopupMasterTemplates[p].id;break;}}}}}
var obj=GetTipTemplateFromDOMAndMasterTemplate(templateId);if(obj==null)
return;var divPopup=null;var text=null;var boundingClientRect;if(source.range){if(source.range.collapsed==true)
return;boundingClientRect=source.range.getBoundingClientRect();text=source.range.toString();}
else if(source.firstNode){text=source.firstNode.SimpleHighlight.textComplete;boundingClientRect=GetHighlightBoundingClientRect(source.firstNode);}
else{text=source.text;boundingClientRect=source.boundingClientRect;}
if(text==null||boundingClientRect==null)
return;if(source.allowMultiple!=true)
RemoveAllTipPopups();divPopup=CreateTipPopup(boundingClientRect,templateId);if(divPopup==null)
return;if(source.firstNode!=null){source.firstNode.SimpleHighlight.divTipPopup=divPopup;divPopup.firstNode=source.firstNode;}
divPopup.divMain.masterTemplate=obj.masterTemplate;ShowWaitingTipPopup(divPopup,true);var request={msg:"requestTip",tipTemplate:obj.template,text:text,msgSet:msgSetTipPopupText,index:divPopup.id,};divPopup.request=request;divPopup.divMain.iframeContent.addEventListener("load",function(e){chrome.extension.sendRequest(e.currentTarget.divPopup.request);});}
function CreateTipPopup(boundingClientRect,templateId){function PopulateSelectTemplate(select,idSelect){var optgroup=null;for(var p in _arrTipPopupMasterTemplates){if(_arrTipPopupMasterTemplates[p].display==false)
continue;if(_arrTipPopupMasterTemplates[p].groupStart==true){optgroup=document.createElement('optgroup');optgroup.label=_arrTipPopupMasterTemplates[p].label;select.appendChild(optgroup);continue;}
else if(_arrTipPopupMasterTemplates[p].groupEnd==true){optgroup=null;continue;}
else{var option=new Option(_arrTipPopupMasterTemplates[p].name,_arrTipPopupMasterTemplates[p].id);option.selected=_arrTipPopupMasterTemplates[p].id==idSelect?true:false;if(_arrTipPopupMasterTemplates[p].description)
option.title=_arrTipPopupMasterTemplates[p].description;if(optgroup)
optgroup.appendChild(option);else
select.options.add(option);}}}
function OnClickCapturedElement(e){if(e.target==null||e.target.nodeType!=Node.ELEMENT_NODE)
return;if(e.target.nodeName=="A"){if(e.button!=0||e.ctrlKey==true||e.altKey==true||e.shiftKey==true)
return;if(OnClickAnchor({tipId:e.currentTarget.divPopup.id,href:e.target.href,target:e.target.target,hostname:e.target.hostname,pathname:e.target.pathname,search:e.target.search,hash:e.target.hash,})==true){e.preventDefault();}}}
var divPopup=document.createElement('div');divPopup.className=CSS2.CLASS_TIP;divPopup.style.setProperty("z-index",BASEZINDEX_TIP,"important");divPopup.id=RandomString(8);divPopup.arrRequestStack=[];divPopup.cursorRequestStack=null;divPopup.boundingClientRect=boundingClientRect;divPopup.scrollTopBody=document.body.scrollTop;divPopup.scrollLeftBody=document.body.scrollLeft;divPopup.style.setProperty("opacity",OPACITY_TIP_MOUSEOUT,"important");var divArrowUp=divPopup.divArrowUp=document.createElement('div');divArrowUp.className=CSS2.CLASS_TIP_ARROW;divArrowUp.style.setProperty("margin-bottom",(-BORDERWIDTH_TIP-SHADOWWIDTH_TIP-BORDERWIDTH_TIP)+"px","important");var canvasUp=divArrowUp.canvas=document.createElement('canvas');canvasUp.className=CSS2.CLASS_TIP_CANVASARROWUP;divArrowUp.appendChild(canvasUp);divPopup.appendChild(divArrowUp);var divMain=divPopup.divMain=document.createElement('div');divMain.className=CSS2.CLASS_TIP_MAIN;divMain.divPopup=divPopup;divMain.style.setProperty("border",BORDERWIDTH_TIP+'px solid '+BORDERCOLOUR_TIP,"important");divMain.style.setProperty("background-color",BACKGROUNDCOLOUR_TIP,"important");divMain.style.setProperty("border-radius",BORDERRADIUS_TIP+"px","important");divMain.style.setProperty("padding",BORDERRADIUS_TIP+2+"px","important");divMain.style.setProperty("-webkit-box-shadow",SHADOWWIDTH_TIP+"px "+SHADOWHEIGHT_TIP+"px "+SHADOWBLUR_TIP+"px "+SHADOWCOLOUR_TIP,"important");divMain.addEventListener("mouseover",function(e){e.currentTarget.divPopup.style.setProperty("opacity",OPACITY_TIP_MOUSEOVER,"important");e.currentTarget.imgClose.style.setProperty("opacity",OPACITY_TIP_CLOSE_MOUSEOVER,"important");});divMain.addEventListener("mouseout",function(e){e.currentTarget.divPopup.style.setProperty("opacity",OPACITY_TIP_MOUSEOUT,"important");e.currentTarget.imgClose.style.setProperty("opacity",OPACITY_TIP_CLOSE_MOUSEOUT,"important");});var imgClose=divPopup.divMain.imgClose=document.createElement('img');imgClose.className=CSS2.CLASS_TIP_CLOSE;imgClose.src=chrome.extension.getURL('img/cross-small-5.png');imgClose.title=TOOLTIP_TIP_CLOSE;imgClose.divPopup=divPopup;imgClose.style.setProperty("opacity",OPACITY_TIP_CLOSE_MOUSEOUT,"important");imgClose.addEventListener("mouseup",function(e){if(e.button==0)
RemoveTipPopup(e.currentTarget.divPopup);});divMain.appendChild(imgClose);var divBar=divMain.divBar=document.createElement('div');divBar.className=CSS2.CLASS_TIP_BAR;divBar.divPopup=divPopup;var divTBRow=divBar.divTBRow=document.createElement('div');divTBRow.className=CSS2.CLASS_TIP_BAR_ROW;divBar.appendChild(divTBRow);var divTBCellLeft=divTBRow.divTBCellLeft=document.createElement('div');divTBCellLeft.className=CSS2.CLASS_TIP_BAR_CELL+" "+CSS2.CLASS_TIP_BAR_CELL_LEFT;divTBRow.appendChild(divTBCellLeft);var arrBackForward=[{srcImage:'img/arrow-180-green.png',title:TOOLTIP_TIP_TIP_BACK,cursorOffset:-1},{srcImage:'img/arrow-green.png',title:TOOLTIP_TIP_TIP_FORWARD,cursorOffset:1},];var spanBackForwardContainer=divBar.spanBackForwardContainer=document.createElement('span');spanBackForwardContainer.className=CSS2.CLASS_TIP_BAR_BUTTONCONTAINER;spanBackForwardContainer.style.setProperty("margin-right","6px","important");for(var a in arrBackForward){var anchor=document.createElement('a');anchor.className=CSS2.CLASS_TIP_BAR_BUTTON;anchor.href="#";anchor.title=arrBackForward[a].title;var img=anchor.img=document.createElement('img');img.src=chrome.extension.getURL(arrBackForward[a].srcImage);img.className=CSS2.CLASS_TIP_BAR_BUTTONIMAGE;anchor.appendChild(img);anchor.cursorOffset=arrBackForward[a].cursorOffset;anchor.divPopup=divPopup;anchor.addEventListener("click",function(e){e.preventDefault();var anchor=e.currentTarget;if(anchor.disabled==true)
return;anchor.divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");anchor.divPopup.cursorRequestStack+=anchor.cursorOffset;anchor.divPopup.request=_clone(anchor.divPopup.arrRequestStack[anchor.divPopup.cursorRequestStack]);anchor.divPopup.request.tipTemplate.sessionData.isSourceCursorChange=true;chrome.extension.sendRequest(anchor.divPopup.request);UpdateBackForwardButtons(anchor.divPopup);},true);spanBackForwardContainer.appendChild(anchor);}
UpdateBackForwardButtons(divPopup);divTBCellLeft.appendChild(spanBackForwardContainer);var spanRefresh=divBar.spanRefresh=document.createElement('span');spanRefresh.className=CSS2.CLASS_TIP_BAR_REFRESH;divTBCellLeft.appendChild(spanRefresh);var spanPaging=divBar.spanPaging=document.createElement('span');spanPaging.className=CSS2.CLASS_TIP_BAR_PAGING;divTBCellLeft.appendChild(spanPaging);var spanNoticeButtons=divBar.spanNoticeButtons=document.createElement('span');spanNoticeButtons.className=CSS2.CLASS_TIP_BAR_BUTTONCONTAINER;spanNoticeButtons.style.setProperty("margin-right","6px","important");divTBCellLeft.appendChild(spanNoticeButtons);var divTBCellRight=divTBRow.divTBCellRight=document.createElement('div');divTBCellRight.className=CSS2.CLASS_TIP_BAR_CELL+" "+CSS2.CLASS_TIP_BAR_CELL_RIGHT;divTBRow.appendChild(divTBCellRight);var imgWaiting=divBar.imgWaiting=document.createElement('img');imgWaiting.className=CSS2.CLASS_TIP_BAR_WAITING;imgWaiting.src=chrome.extension.getURL('img/ajax-loader.gif');divTBCellRight.appendChild(imgWaiting);var spanDisplayTitle=divBar.spanDisplayTitle=document.createElement('span');spanDisplayTitle.className=CSS2.CLASS_TIP_BAR_DISPLAYTITLE;divTBCellRight.appendChild(spanDisplayTitle);var spanBrand=divBar.spanBrand=document.createElement('span');spanBrand.className=CSS2.CLASS_TIP_BAR_BRAND;spanBrand.style.setProperty("margin-left","6px","important");divTBCellRight.appendChild(spanBrand);var spanTemplateContainer=divBar.spanTemplateContainer=document.createElement('span');spanTemplateContainer.className=CSS2.CLASS_TIP_BAR_BUTTONCONTAINER;spanTemplateContainer.style.setProperty("margin-left","6px","important");var imgTemplateIcon=divBar.imgTemplateIcon=document.createElement('img');imgTemplateIcon.className=CSS2.CLASS_TIP_BAR_FLAG;imgTemplateIcon.style.setProperty("margin-right","3px","important");imgTemplateIcon.style.setProperty("display","none","important");spanTemplateContainer.appendChild(imgTemplateIcon);var selectTemplate=divBar.selectTemplate=document.createElement('select');selectTemplate.divPopup=divPopup;selectTemplate.className=CSS2.CLASS_TIP_BAR_SELECT;selectTemplate.title=TOOLTIP_TIP_SELECTTEMPLATE;selectTemplate.addEventListener("change",OnSelectTipTemplateChange,false);selectTemplate.addEventListener("keyup",OnSelectTipTemplateChange,false);PopulateSelectTemplate(selectTemplate,templateId);OnSelectTipTemplateChange({currentTarget:selectTemplate},{updateBranding:true,prepareRequest:false,issueRequest:false,setDefaultTemplate:false});spanTemplateContainer.appendChild(selectTemplate);divTBCellRight.appendChild(spanTemplateContainer);divMain.appendChild(divBar);var divNoticeBars=divMain.divNoticeBars=document.createElement('div');divNoticeBars.className=CSS2.CLASS_TIP_NOTICEBARSCONTAINER;divNoticeBars.divPopup=divPopup;divNoticeBars.style.setProperty("display","none","important");divNoticeBars.style.setProperty("max-height",MAXHEIGHT_NOTICEBARS_TIP,"important");divNoticeBars.addEventListener("click",OnClickCapturedElement,true);divMain.appendChild(divNoticeBars);var iframeContent=divMain.iframeContent=document.createElement('iframe');iframeContent.name=RandomString(64);iframeContent.className=CSS2.CLASS_TIP_IFRAMECONTENT;iframeContent.frameBorder=0;iframeContent.divPopup=divPopup;iframeContent.addEventListener("load",function(e){var arr=[{type:"tip",cssId:[CSSID_CHROME_IFRAME,CSSID_MEDIAWIKI,CSSID_YAHOOWEB,CSSID_TWITTER,CSSID_GOOGLEIMAGESEARCH,]}];for(var q in arr){for(var r in arr[q].cssId)
chrome.extension.sendRequest({msg:"relayRequest",msgRelay:MSG_TIP_CONTENT_APPENDSTYLESHEET,tipId:e.currentTarget.divPopup.id,textContent:CSS2.BuildStyleSheet(arr[q].type,arr[q].cssId[r])});}});divMain.appendChild(iframeContent);iframeContent.src=chrome.extension.getURL("tip.html")+"?"+"tipId="+divPopup.id+"&ass="+MSG_TIP_CONTENT_APPENDSTYLESHEET+"&sbi="+MSG_TIP_CONTENT_SETBODYINNERHTML+"&ss="+MSG_TIP_CONTENT_SHOWSECTION+"&gd="+MSG_TIP_CONTENT_GETDIMENSIONS+"&sl2stn="+MSG_TIP_CONTENT_SETLEVEL2SECTIONTAGNAMES+"&oca="+MSG_TIP_CONTENT_ONCLICKANCHOR+"&osc="+MSG_TIP_CONTENT_ONSIZECHANGE;divPopup.appendChild(divMain);var divArrowDown=divPopup.divArrowDown=document.createElement('div');divArrowDown.className=CSS2.CLASS_TIP_ARROW;divArrowDown.style.setProperty("margin-top",-BORDERWIDTH_TIP+"px","important");var canvasDown=divArrowDown.canvas=document.createElement('canvas');canvasDown.className=CSS2.CLASS_TIP_CANVASARROWDOWN;divArrowDown.appendChild(canvasDown);divPopup.appendChild(divArrowDown);canvasUp.width=canvasDown.width=CANVASWIDTH_TIP_ARROW+SHADOWWIDTH_TIP+BORDERWIDTH_TIP;canvasUp.height=canvasDown.height=CANVASHEIGHT_TIP_ARROW+SHADOWHEIGHT_TIP+BORDERWIDTH_TIP;document.body.appendChild(divPopup);PositionTipPopup(divPopup,null);return divPopup;}
function RemoveAllTipPopups(){var divPopups=document.getElementsByClassName(CSS2.CLASS_TIP);for(var x=divPopups.length-1;x>=0;x--)
RemoveTipPopup(divPopups[x]);}
function RemoveTipPopup(divPopup){chrome.extension.sendRequest({msg:"releaseTipObject",id:divPopup.id});if(divPopup.firstNode)
divPopup.firstNode.SimpleHighlight.divTipPopup=null;document.body.removeChild(divPopup);}
function OnClickAnchorIFrame(request){if(OnClickAnchor(request)==false)
window.open(request.href,request.target);}
function OnClickAnchor(request){var divPopup=document.getElementById(request.tipId);if(divPopup==null)
return false;if(DoesTemplateIdHaveMediaWikiAPI(divPopup.request.tipTemplate.id)==true){if(request.classListContainsMediaWikiNew==true)
return false;if(request.pathname.indexOf(':')!=-1){var legal=false;var arrTokens=request.pathname.split('/');if(arrTokens.length>=2){if(arrTokens[arrTokens.length-2]==MEDIAWIKI_TOKEN_SPECIALSEARCH)
legal=true;else if(request.attrLangParent!=null){legal=true;}}
if(legal==false)
return false;}
var aCurrentPage=document.createElement('a');aCurrentPage.href=divPopup.request.tipTemplate.sessionData.hrefWikiPage;var idHash=request.hash.length>0?request.hash.substring(1):null;if(request.host==aCurrentPage.host&&request.pathname==aCurrentPage.pathname&&request.protocol==aCurrentPage.protocol&&request.search==aCurrentPage.search){var selectSection=divPopup.divMain.divBar.spanPaging.selectSection;selectSection.value=request.idL2SectionMediaWiki;OnChangeSection_MediaWiki({type:"change",currentTarget:selectSection},idHash);return true;}
if(request.host!=aCurrentPage.host){var found_template=false;for(var y in _arrTipPopupMasterTemplates){if(_arrTipPopupMasterTemplates[y].defaultOptions==null||_arrTipPopupMasterTemplates[y].defaultOptions.hasMediaWikiAPI!=true)
continue;var idx=request.hostname.lastIndexOf(_arrTipPopupMasterTemplates[y].defaultOptions.domain);if(idx==-1)
continue;if(idx>=1&&request.hostname[idx-1]!='.')
continue;divPopup.divMain.divBar.selectTemplate.value=_arrTipPopupMasterTemplates[y].id;OnSelectTipTemplateChange({currentTarget:divPopup.divMain.divBar.selectTemplate},{updateBranding:true,prepareRequest:true,issueRequest:false});found_template=true;break;}
if(found_template==false)
return false;}
if(divPopup.request.tipTemplate.options.pathWiki!=request.pathname.substring(0,divPopup.request.tipTemplate.options.pathWiki.length))
return false;var editionLanguage=request.attrLangParent?request.attrLangParent:request.hostname.substr(0,request.hostname.indexOf('.'));var index=request.pathname.lastIndexOf('/');var query=request.pathname.substr(index+1);if(request.attrLangParent){var arrColon=query.split(":");if(arrColon.length>=2)
query=arrColon[arrColon.length-1];}
divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");divPopup.request=_clone(divPopup.request);divPopup.request.text=decodeURIComponent(query);divPopup.request.tipTemplate.sessionData.hash=idHash;divPopup.request.tipTemplate.sessionData.search=request.search;divPopup.request.tipTemplate.options.editionLanguage=editionLanguage;chrome.extension.sendRequest(divPopup.request);return true;}
return false;}
function UpdateBackForwardButtons(divPopup){var anchors=divPopup.divMain.divBar.spanBackForwardContainer.getElementsByTagName('A');for(var a=0;a<anchors.length;a++){var cursorNew=(divPopup.cursorRequestStack==null?-1:divPopup.cursorRequestStack+anchors[a].cursorOffset);anchors[a].disabled=(cursorNew<0||cursorNew>=divPopup.arrRequestStack.length)?true:false;anchors[a].style.setProperty("opacity",anchors[a].disabled==true?OPACITY_BUTTON_DISABLED:OPACITY_BUTTON_ENABLED,"important");}}
function OnSelectTipTemplateChange(e,mask){if(e.type=="keyup"&&e.currentTarget.lastSelectedIndex==e.currentTarget.selectedIndex)
return;e.currentTarget.lastSelectedIndex=e.currentTarget.selectedIndex;var obj=GetTipTemplateFromDOMAndMasterTemplate(e.currentTarget.value);if(obj!=null&&obj.template!=null&&obj.masterTemplate!=null){var divPopup=e.currentTarget.divPopup;if(mask==null||mask.updateBranding==true){divPopup.divMain.divBar.spanBrand.innerHTML=obj.masterTemplate.branding?obj.masterTemplate.branding:"";}
if(mask==null||mask.prepareRequest==true){divPopup.divMain.masterTemplate=obj.masterTemplate;divPopup.request.tipTemplate=obj.template;divPopup.request.tipTemplate.sessionData.tip_position_locked=false;ShowWaitingTipPopup(e.currentTarget.divPopup,true);chrome.extension.sendRequest({msg:"releaseTipObject",id:e.currentTarget.divPopup.id});}
if(mask==null||mask.issueRequest==true){chrome.extension.sendRequest(e.currentTarget.divPopup.request);}
if(mask==null||mask.setDefaultTemplate==true){for(var x in arrTipPopupTemplates){arrTipPopupTemplates[x].default=(arrTipPopupTemplates[x].id==e.currentTarget.value)?true:false;}}}}
function PositionTipPopup(divPopup,args){var topSelection=divPopup.boundingClientRect.top+divPopup.scrollTopBody;var leftSelection=divPopup.boundingClientRect.left+divPopup.scrollLeftBody;var widthSelection=divPopup.boundingClientRect.width;var heightSelection=divPopup.boundingClientRect.height;if(args&&args.dimensionsIFrameBody){if(args.dimensionsIFrameBody.remove_width==true)
divPopup.divMain.iframeContent.style.setProperty("width","0px","important");if(args.dimensionsIFrameBody.remove_width==true)
divPopup.style.removeProperty("width");else if(args.dimensionsIFrameBody.width)
divPopup.style.setProperty("width",args.dimensionsIFrameBody.width+GetScrollBarWidth()+"px","important");if(args.dimensionsIFrameBody.remove_height==true)
divPopup.divMain.iframeContent.style.removeProperty("height");else if(args.dimensionsIFrameBody.height)
divPopup.divMain.iframeContent.style.setProperty("height",args.dimensionsIFrameBody.height+"px","important");}
if(args){if(args.optimizeMaxWidthFor=="selection"){divPopup.style.removeProperty("max-width");}
else if(args.optimizeMaxWidthFor=="default")
divPopup.style.setProperty("max-width",Math.max(800,((document.body.clientWidth/4)*2))+"px","important");}
var heightArrow=CANVASHEIGHT_TIP_ARROW+SHADOWHEIGHT_TIP+BORDERWIDTH_TIP;var paddingMain=parseFloat(divPopup.divMain.style.getPropertyValue("padding"));var heightBar=divPopup.divMain.divBar.offsetHeight;divPopup.divMain.iframeContent.style.setProperty("max-height",Math.max(0,(window.innerHeight-80-heightArrow-paddingMain-heightBar))+"px","important");if(args==null||args.set_origin==true){var top=topSelection-divPopup.offsetHeight;var left=leftSelection+(widthSelection/2)-(divPopup.offsetWidth/2);var textAlignArrow="center";var paddingArrowLeft=paddingArrowRight=0;var divArrow;if(top-document.body.scrollTop<1){top=topSelection+heightSelection;divArrow=divPopup.divArrowUp;}
else
divArrow=divPopup.divArrowDown;if(left-document.body.scrollLeft<1){left=leftSelection;textAlignArrow="left";paddingArrowLeft=widthSelection/2;}
if(left+divPopup.offsetWidth>document.body.clientWidth){left=document.body.clientWidth-divPopup.offsetWidth;textAlignArrow="right";paddingArrowRight=widthSelection/2;}
divPopup.divArrowUp.style.setProperty("display",divArrow==divPopup.divArrowUp?"":"none","important");divPopup.divArrowDown.style.setProperty("display",divArrow==divPopup.divArrowDown?"":"none","important");divPopup.style.setProperty("top",top+"px","important");divPopup.style.setProperty("left",left+"px","important");divArrow.style.setProperty("text-align",textAlignArrow,"important");divArrow.style.setProperty("padding-left",paddingArrowLeft+"px","important");divArrow.style.setProperty("padding-right",paddingArrowRight+"px","important");var context=divArrow.canvas.getContext("2d");context.clearRect(0,0,divArrow.canvas.width,divArrow.canvas.height);function ArrowPointX(align){return CANVASWIDTH_TIP_ARROW/2;}
context.beginPath();if(divArrow==divPopup.divArrowDown){context.moveTo(0,0);context.lineTo(CANVASWIDTH_TIP_ARROW,0);context.lineTo(ArrowPointX(textAlignArrow),CANVASHEIGHT_TIP_ARROW)}else{context.moveTo(0,CANVASHEIGHT_TIP_ARROW);context.lineTo(CANVASWIDTH_TIP_ARROW,CANVASHEIGHT_TIP_ARROW);context.lineTo(ArrowPointX(textAlignArrow),0)}
context.fillStyle=BACKGROUNDCOLOUR_TIP;context.fill();context.beginPath();if(divArrow==divPopup.divArrowDown){context.moveTo(0,0);context.lineTo(ArrowPointX(textAlignArrow),CANVASHEIGHT_TIP_ARROW)
context.lineTo(CANVASWIDTH_TIP_ARROW,0);}else{context.moveTo(0,CANVASHEIGHT_TIP_ARROW);context.lineTo(ArrowPointX(textAlignArrow),0)
context.lineTo(CANVASWIDTH_TIP_ARROW,CANVASHEIGHT_TIP_ARROW);}
context.shadowColor="rgba(0,0,0,0)";context.strokeStyle=BORDERCOLOUR_TIP;context.lineWidth=BORDERWIDTH_TIP;context.stroke();}
if(args&&args.dimensionsIFrameBody&&args.dimensionsIFrameBody.remove_width==true)
divPopup.divMain.iframeContent.style.removeProperty("width");}
function OnWaitingTipPopupMouseOver(e){ShowWaitingTipPopupBarControls(e.currentTarget.divPopup,false,true);}
function ShowWaitingTipPopupBarControls(divPopup,hide,repositionPopup){var divBar=divPopup.divMain.divBar;divBar.divTBRow.divTBCellLeft.style.setProperty("display",hide==true?"none":"","important");divBar.spanDisplayTitle.style.setProperty("display",hide==true?"none":"","important");divBar.spanBrand.style.setProperty("display",hide==true?"none":"","important");divBar.spanTemplateContainer.style.setProperty("display",hide==true?"none":"","important");if(repositionPopup==true)
PositionTipPopup(divPopup);}
function ShowWaitingTipPopup(divPopup,show){var divBar=divPopup.divMain.divBar;var iframeContent=divPopup.divMain.iframeContent;divBar.imgWaiting.style.setProperty("visibility",show==true?"visible":"hidden","important");divPopup.divMain.divNoticeBars.style.setProperty("display",show==true?"none":"","important");iframeContent.style.setProperty("display",show==true?"none":"","important");ShowWaitingTipPopupBarControls(divPopup,show,show);divBar.spanPaging.style.setProperty("display",show==true?"none":"","important");divBar.spanNoticeButtons.style.setProperty("display",show==true?"none":"","important");if(show==true){divPopup.divMain.addEventListener("mouseover",OnWaitingTipPopupMouseOver,true);}
else{divPopup.divMain.removeEventListener("mouseover",OnWaitingTipPopupMouseOver,true);}}
function OnSetTipPopupText(tipId,templateId,data){var divPopup=document.getElementById(tipId);if(divPopup==null||divPopup.divMain==null||divPopup.request.tipTemplate==null)
return;var isSourceCursorChange=divPopup.request.tipTemplate.sessionData.isSourceCursorChange;divPopup.request.tipTemplate.sessionData.isSourceCursorChange=false;if(templateId!=divPopup.request.tipTemplate.id)
return;var divContentHolder=document.createElement('div');var iframeContent=divPopup.divMain.iframeContent;var divBar=divPopup.divMain.divBar;divBar.spanRefresh.innerHTML=null;divBar.spanPaging.innerHTML=null;divBar.spanDisplayTitle.innerHTML=null;RemoveAllNoticeBars(divPopup);ShowWaitingTipPopup(divPopup,false);var styleControlObj={};if(isSourceCursorChange!=true){if(divPopup.cursorRequestStack!=null)
divPopup.arrRequestStack=divPopup.arrRequestStack.slice(0,divPopup.cursorRequestStack+1);divPopup.arrRequestStack.push(_clone(divPopup.request));divPopup.cursorRequestStack=divPopup.arrRequestStack.length-1;UpdateBackForwardButtons(divPopup);}
divBar.selectTemplate.value=divPopup.request.tipTemplate.id;OnSelectTipTemplateChange({currentTarget:divBar.selectTemplate},{updateBranding:true});var spanContainer=document.createElement('span');spanContainer.className=CSS2.CLASS_TIP_BAR_BUTTONCONTAINER;spanContainer.style.setProperty("margin-right","6px","important");var aRefresh=document.createElement('a');aRefresh.className=CSS2.CLASS_TIP_BAR_BUTTON;aRefresh.href="#";aRefresh.title=TOOLTIP_TIP_TWITTER_REFRESH;aRefresh.divPopup=divPopup;var imgRefresh=document.createElement('img');imgRefresh.src=chrome.extension.getURL("img/arrow-circle-315.png");imgRefresh.className=CSS2.CLASS_TIP_BAR_BUTTONIMAGE;aRefresh.appendChild(imgRefresh);spanContainer.appendChild(aRefresh);var aTTS=divBar.aTTS=document.createElement('a');aTTS.className=CSS2.CLASS_TIP_BAR_BUTTON;aTTS.href="#";aTTS.title=TOOLTIP_TIP_TTS;aTTS.divPopup=divPopup;var imgTTS=document.createElement('img');imgTTS.src=chrome.extension.getURL("img/speaker-volume-low2.png");imgTTS.className=CSS2.CLASS_TIP_BAR_BUTTONIMAGE;aTTS.appendChild(imgTTS);aTTS.addEventListener("click",function(e){e.preventDefault();chrome.extension.sendRequest({msg:"nativeSpeak",utterance:e.currentTarget.divPopup.divMain.divBar.aTTS.SimpleHighlight.utterance,options:{lang:e.currentTarget.divPopup.divMain.divBar.aTTS.SimpleHighlight.lang}});},true);spanContainer.appendChild(aTTS);divBar.spanRefresh.appendChild(spanContainer);var arr=[{templateId:ID_TIPPOPUP_MSTRANSLATE_TTS,func:OnSetTipPopupText_MSTranslateTTS},{templateId:ID_TIPPOPUP_MSTRANSLATE_TRANSLATE,func:OnSetTipPopupText_MSTranslateTranslate},{templateId:ID_TIPPOPUP_FLICKR,func:OnSetTipPopupText_Flickr},{templateId:ID_TIPPOPUP_YAHOOSPELLING,func:OnSetTipPopupText_YahooSpelling},{templateId:ID_TIPPOPUP_YAHOOWEB,func:OnSetTipPopupText_YahooWeb},{templateId:ID_TIPPOPUP_GOOGLETRANSLATE,func:OnSetTipPopupText_GoogleTranslate},{templateId:ID_TIPPOPUP_GOOGLELANGUAGEDETECT,func:OnSetTipPopupText_GoogleLanguageDetect},{templateId:ID_TIPPOPUP_GOOGLEIMAGESEARCH,func:OnSetTipPopupText_GoogleImageSearch},{templateId:ID_TIPPOPUP_GOOGLETTS,func:OnSetTipPopupText_GoogleTTS},{templateId:ID_TIPPOPUP_TWITTER,func:OnSetTipPopupText_TwitterSearch},];var func=null;if(DoesTemplateIdHaveMediaWikiAPI(divPopup.request.tipTemplate.id))
func=OnSetTipPopupText_WikiMedia;else{for(var y in arr){if(divPopup.request.tipTemplate.id==arr[y].templateId){func=arr[y].func;break;}}}
if(func)
styleControlObj=func(divPopup,divContentHolder,divPopup.divMain.divBar,data);if(data.errorHTML||data.warningHTML){var imgIcon=document.createElement('img');imgIcon.className=CSS2.CLASS_TIP_CONTENT_ICON;imgIcon.src=chrome.extension.getURL('img/exclamation'+(data.errorHTML?'-red':'')+'.png');divContentHolder.appendChild(imgIcon);divContentHolder.appendChild(document.createElement('br'));divContentHolder.innerHTML+=(data.errorHTML?data.errorHTML:data.warningHTML);styleControlObj.textAlignContent="center";styleControlObj.lock_tip_position=false;styleControlObj.optimizeMaxWidthFor="selection";}
var arr=[{varName:"showDisplayTitle",elem:divBar.spanDisplayTitle},{varName:"showPaging",elem:divBar.spanPaging},{varName:"showTemplateIcon",elem:divBar.imgTemplateIcon},{varName:"showNoticeButtons",elem:divBar.spanNoticeButtons},];for(var d in arr)
arr[d].elem.style.setProperty("display",styleControlObj[arr[d].varName]==true?"":"none","important");if(!styleControlObj.ttsUtterance)
styleControlObj.ttsUtterance=divPopup.request.text,aTTS.style.setProperty("display",styleControlObj.ttsUtterance?"":"none","important");aTTS.SimpleHighlight={utterance:styleControlObj.ttsUtterance,lang:styleControlObj.ttsLang};aRefresh.addEventListener("click",styleControlObj.onClickRefresh?styleControlObj.onClickRefresh:function(e){e.preventDefault();e.currentTarget.divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");e.currentTarget.divPopup.request.tipTemplate.sessionData.isSourceCursorChange=true;chrome.extension.sendRequest(e.currentTarget.divPopup.request);},true);if(HIDE_WHILST_CALCULATING_IFRAME_SIZE==true)
divPopup.style.setProperty("visibility","hidden","important");PositionTipPopup(divPopup,{set_origin:false,optimizeMaxWidthFor:styleControlObj.optimizeMaxWidthFor,dimensionsIFrameBody:{remove_width:styleControlObj.optimizeMaxWidthFor=="selection"?true:false,width:document.body.clientWidth,remove_height:true,height:0}});chrome.extension.sendRequest({msg:"relayRequest",msgRelay:MSG_TIP_CONTENT_SETBODYINNERHTML,tipId:tipId,innerHTML:divContentHolder.innerHTML,textAlign:styleControlObj.textAlignContent,tipTemplateId:divPopup.request.tipTemplate.id,classNameL2SectionMediaWiki:divPopup.request.tipTemplate.sessionData.classNameL2SectionMediaWiki,showSection:styleControlObj.showSection,level2SectionTagName:styleControlObj.level2SectionTagName,callbackData:{tipId:tipId,styleControlObj:styleControlObj,}},function(reply){chrome.extension.sendRequest({msg:"relayRequest",msgRelay:MSG_TIP_CONTENT_GETDIMENSIONS,tipId:reply.callbackData.tipId,callbackData:reply.callbackData},function(r){var divPopup=document.getElementById(r.callbackData.tipId);if(divPopup){var height;if(DoesTemplateIdHaveMediaWikiAPI(divPopup.request.tipTemplate.id)==true){height=(divPopup.anchorButtonInfoBox&&divPopup.anchorButtonInfoBox.selected==true)?r.scrollHeight+PADDING_HEIGHT_WITH_INFOBOXCONTAINER:r.offsetHeight;}
else
height=r.offsetHeight;PositionTipPopup(divPopup,{set_origin:divPopup.request.tipTemplate.sessionData.tip_position_locked!=true?true:false,optimizeMaxWidthFor:r.callbackData.styleControlObj.optimizeMaxWidthFor,dimensionsIFrameBody:{remove_width:r.callbackData.styleControlObj.optimizeMaxWidthFor=="selection"?true:false,width:r.scrollWidth,height:height,}});}
if(HIDE_WHILST_CALCULATING_IFRAME_SIZE==true)
divPopup.style.setProperty("visibility","visible","important");});var divPopup=document.getElementById(reply.callbackData.tipId);if(divPopup){if(DoesTemplateIdHaveMediaWikiAPI(divPopup.request.tipTemplate.id)==true){var selectSection=divPopup.divMain.divBar.spanPaging.selectSection;if(selectSection){if(reply.showSectionReply)
selectSection.value=reply.showSectionReply.idSection;else
selectSection.selectedIndex=0;if(selectSection.spanUpDownContainer)
UpdateUpDownButtons_MediaWiki(selectSection.spanUpDownContainer,selectSection);if(divPopup.request.tipTemplate.options.rememberLastSection==true)
divPopup.request.tipTemplate.options.idLastSection=selectSection.value;}}}});}
function OnSetTipPopupText_TwitterSearch(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"left",optimizeMaxWidthFor:"default",showPaging:true,lock_tip_position:true,};if(data.since_id!=null)
divPopup.request.tipTemplate.sessionData.since_id=data.since_id;if(data.max_id!=null)
divPopup.request.tipTemplate.sessionData.max_id=data.max_id;if(data.offset_recent_correction!=null)
divPopup.request.tipTemplate.sessionData.offset_recent_correction=data.offset_recent_correction;if(data.moreResultsUrl){styleControlObj.showDisplayTitle=true;var aMore=document.createElement('a');aMore.href=data.moreResultsUrl;aMore.target="_blank";aMore.title=divPopup.request.text;aMore.innerText=divPopup.request.text.ellipsis(MAXCHARS_TIP_DISPLAYTITLE);divBar.spanDisplayTitle.appendChild(aMore);}
styleControlObj.onClickRefresh=function(e){e.preventDefault();e.currentTarget.divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");e.currentTarget.divPopup.request=_clone(e.currentTarget.divPopup.request);e.currentTarget.divPopup.request.tipTemplate.sessionData.isSourceCursorChange=true;e.currentTarget.divPopup.request.tipTemplate.sessionData.refresh=true;e.currentTarget.divPopup.request.tipTemplate.sessionData.page=1;chrome.extension.sendRequest(e.currentTarget.divPopup.request);}
if(data.is_next==true||data.is_previous==true){function OnClick(e){e.preventDefault();if(e.currentTarget.disabled==true)
return;e.currentTarget.divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");e.currentTarget.divPopup.request=_clone(e.currentTarget.divPopup.request);e.currentTarget.divPopup.request.tipTemplate.sessionData.page=e.currentTarget.pageNew;e.currentTarget.divPopup.request.tipTemplate.sessionData.refresh=false;chrome.extension.sendRequest(e.currentTarget.divPopup.request);}
AddPagingElements(divPopup,divBar.spanPaging,data.is_previous==false?1:data.page,data.is_next?(data.page+1):data.page,OnClick,{unknownTotalPages:true});}
if(data.entries&&data.entries.length>0){var ol=document.createElement('ol');ol.className=CSS2.CLASS_TIP_CONTENT_TWITTER_ORDEREDLIST;for(var q in data.entries){var li=document.createElement('li');li.className=CSS2.CLASS_TIP_CONTENT_TWITTER_LISTITEM;if(q==data.entries.length-1)
li.style.setProperty("margin-bottom","0px","important");if(data.entries[q].result_type=="popular")
li.className+=" "+CSS2.CLASS_TIP_CONTENT_TWITTER_LISTITEM_POPULAR;var aAuthorImage=document.createElement('a');aAuthorImage.className=CSS2.CLASS_TIP_CONTENT_TWITTER_AVATAR;aAuthorImage.href=data.entries[q].author.uri;aAuthorImage.target="_blank";var imgAuthorImage=document.createElement('img');imgAuthorImage.className=CSS2.CLASS_TIP_CONTENT_TWITTER_AVATARIMAGE;imgAuthorImage.src=data.entries[q].author.srcImage;imgAuthorImage.width=imgAuthorImage.height=48;aAuthorImage.appendChild(imgAuthorImage);li.appendChild(aAuthorImage);var aPublished=document.createElement('a');aPublished.className=CSS2.CLASS_TIP_CONTENT_TWITTER_PUBLISHED;aPublished.innerText=TimeAgo(new Date(data.entries[q].published));aPublished.href=data.entries[q].url;aPublished.target="_blank";li.appendChild(aPublished);var aName=document.createElement('a');aName.className=CSS2.CLASS_TIP_CONTENT_TWITTER_ATNAME;aName.href=data.entries[q].author.uri;aName.target="_blank";aName.innerText=data.entries[q].author.name;li.appendChild(aName);if(data.entries[q].author.realname){var spanRealName=document.createElement('span');spanRealName.className=CSS2.CLASS_TIP_CONTENT_TWITTER_REALNAME;spanRealName.innerText=data.entries[q].author.realname;li.appendChild(spanRealName);}
if(data.entries[q].recent_retweets){var imgRR=document.createElement('img');imgRR.className=CSS2.CLASS_TIP_CONTENT_TWITTER_RETWEETEDIMAGE;imgRR.src=chrome.extension.getURL("img/retweet.png");imgRR.title=TOOLTIP_TIP_TWITTER_RETWEETS;li.appendChild(imgRR);var spanRR=document.createElement('span');spanRR.className=CSS2.CLASS_TIP_CONTENT_TWITTER_RETWEETS;spanRR.innerText=data.entries[q].recent_retweets;li.appendChild(spanRR)}
var divTweet=document.createElement('div');divTweet.className=CSS2.CLASS_TIP_CONTENT_TWITTER_TWEET;divTweet.innerHTML=data.entries[q].content;li.appendChild(divTweet);ol.appendChild(li);}
divContentHolder.appendChild(ol);}
return styleControlObj;}
function OnSetTipPopupText_YahooWeb(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"left",optimizeMaxWidthFor:"default",showPaging:true,lock_tip_position:true,};if(data.moreResultsUrl){styleControlObj.showDisplayTitle=true;var aMore=document.createElement('a');aMore.href=data.moreResultsUrl;aMore.target="_blank";aMore.title=divPopup.request.text;aMore.innerText=divPopup.request.text.ellipsis(MAXCHARS_TIP_DISPLAYTITLE);divBar.spanDisplayTitle.appendChild(aMore);}
if(data.yresp&&data.yresp.resultset_web&&data.yresp.resultset_web.length>0){var ol=document.createElement('ol');ol.className=CSS2.CLASS_TIP_CONTENT_YAHOOWEB_ORDEREDLIST;ol.start=parseInt(data.yresp.start)+1;for(var q in data.yresp.resultset_web){var li=document.createElement('li');if(q==data.yresp.resultset_web.length-1)
li.style.setProperty("margin-bottom","0px","important");li.className=CSS2.CLASS_TIP_CONTENT_YAHOOWEB_LISTITEM;var aTitle=document.createElement('a');aTitle.className=CSS2.CLASS_TIP_CONTENT_YAHOOWEB_HEADER;aTitle.href=data.yresp.resultset_web[q].clickurl;aTitle.target="_blank";aTitle.innerHTML=data.yresp.resultset_web[q].title;li.appendChild(aTitle);if(data.yresp.resultset_web[q].abstract&&data.yresp.resultset_web[q].abstract.length>0){var divAbstract=document.createElement('div');divAbstract.className=CSS2.CLASS_TIP_CONTENT_YAHOOWEB_ABSTRACT;divAbstract.innerHTML=data.yresp.resultset_web[q].abstract;li.appendChild(divAbstract);}
var divFooter=document.createElement('div');divFooter.className=CSS2.CLASS_TIP_CONTENT_YAHOOWEB_FOOTER;var spanURL=document.createElement('span');spanURL.className=CSS2.CLASS_TIP_CONTENT_YAHOOWEB_URL;spanURL.style.setProperty("margin-right","6px","important");spanURL.innerHTML=data.yresp.resultset_web[q].dispurl;divFooter.appendChild(spanURL);var spanSize=document.createElement('span');spanSize.className=CSS2.CLASS_TIP_CONTENT_YAHOOWEB_SIZEDATE;var timeAgo=TimeAgo(new Date(data.yresp.resultset_web[q].date),{days:true,today:true});spanSize.innerHTML=FORMAT_TIP_YAHOOWEB_SIZEDATE.replace("<<SIZE>>",Math.ceil(parseInt(data.yresp.resultset_web[q].size)/1024)).replace("<<DATE>>",timeAgo);divFooter.appendChild(spanSize);li.appendChild(divFooter);ol.appendChild(li);}
divContentHolder.appendChild(ol);}
if(data.pages>1){function OnClick(e){e.preventDefault();if(e.currentTarget.disabled==true)
return;e.currentTarget.divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");e.currentTarget.divPopup.request=_clone(e.currentTarget.divPopup.request);e.currentTarget.divPopup.request.tipTemplate.sessionData.page=e.currentTarget.pageNew;chrome.extension.sendRequest(e.currentTarget.divPopup.request);}
AddPagingElements(divPopup,divBar.spanPaging,data.page,data.pages,OnClick);}
var inputRestrict=divBar.spanPaging.inputRestrict=document.createElement('input');inputRestrict.className=CSS2.CLASS_TIP_BAR_CHECKBOX;inputRestrict.title=TOOLTIP_TIP_RESTRICTTOSITE;inputRestrict.style.setProperty("margin-right","6px","important");inputRestrict.type="checkbox";inputRestrict.checked=data.restrictToHost?data.restrictToHost:false;inputRestrict.id=RandomString(8);inputRestrict.divPopup=divPopup;inputRestrict.addEventListener("change",function(e){e.currentTarget.divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");e.currentTarget.divPopup.request.tipTemplate.options.restrictToHost=e.currentTarget.checked;e.currentTarget.divPopup.request.tipTemplate.sessionData.page=1;chrome.extension.sendRequest(e.currentTarget.divPopup.request);},false);var labelRestrict=document.createElement('label');labelRestrict.className=CSS2.CLASS_TIP_BAR_LEFTLABEL;labelRestrict.htmlFor=inputRestrict.id;labelRestrict.innerHTML=INNERHTML_TIP_RESTRICTTOSITE;labelRestrict.title=inputRestrict.title;divBar.spanPaging.appendChild(inputRestrict);divBar.spanPaging.appendChild(labelRestrict);return styleControlObj;}
function OnSetTipPopupText_GoogleImageSearch(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"left",optimizeMaxWidthFor:"default",showPaging:true,lock_tip_position:true,};if(data.cursor){function OnClickGoogleImageSearch(e){e.currentTarget.divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");chrome.extension.sendRequest({msg:"callTipObjectFunction",id:e.currentTarget.paramId,nameVariable:"imageSearch",nameFunction:"gotoPage",arg:e.currentTarget.paramPage});e.preventDefault();}
styleControlObj.showDisplayTitle=true;var aMore=document.createElement('a');aMore.href=data.cursor.moreResultsUrl;aMore.target="_blank";aMore.title=divPopup.request.text;aMore.innerText=divPopup.request.text.ellipsis(MAXCHARS_TIP_DISPLAYTITLE);divBar.spanDisplayTitle.appendChild(aMore);if(data.cursor.pages.length>1){function OnClick(e){e.preventDefault();if(e.currentTarget.disabled==true)
return;e.currentTarget.divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");chrome.extension.sendRequest({msg:"callTipObjectFunction",id:e.currentTarget.divPopup.id,nameVariable:"imageSearch",nameFunction:"gotoPage",arg:e.currentTarget.pageNew-1});}
AddPagingElements(divPopup,divBar.spanPaging,data.cursor.currentPageIndex+1,data.cursor.pages.length,OnClick);}}
var inputRestrict=divBar.spanPaging.inputRestrict=document.createElement('input');inputRestrict.className=CSS2.CLASS_TIP_BAR_CHECKBOX;inputRestrict.type="checkbox";inputRestrict.title=TOOLTIP_TIP_RESTRICTTOSITE;inputRestrict.checked=data.restrictToHost?data.restrictToHost:false;inputRestrict.id=RandomString(8);inputRestrict.divPopup=divPopup;inputRestrict.addEventListener("change",function(e){e.currentTarget.divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");e.currentTarget.divPopup.request.tipTemplate.options.restrictToHost=e.currentTarget.checked;chrome.extension.sendRequest(e.currentTarget.divPopup.request);},false);var labelRestrict=document.createElement('label');labelRestrict.className=CSS2.CLASS_TIP_BAR_LEFTLABEL;labelRestrict.htmlFor=inputRestrict.id;labelRestrict.innerHTML=INNERHTML_TIP_RESTRICTTOSITE;labelRestrict.title=inputRestrict.title;divBar.spanPaging.appendChild(inputRestrict);divBar.spanPaging.appendChild(labelRestrict);if(data.results){var max_width=max_height=0;for(var a in data.results){if(parseInt(data.results[a].tbWidth)>max_width)
max_width=data.results[a].tbWidth;if(parseInt(data.results[a].tbHeight)>max_height)
max_height=data.results[a].tbHeight;}
for(var a in data.results){var table=document.createElement('div');table.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT;table.style.setProperty("width",max_width+"px","important");var row=document.createElement('div');row.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_ROW;var cell=document.createElement('div');cell.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL+" "+CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL_THUMBNAIL;var anchor=document.createElement('a');anchor.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_THUMBNAILANCHOR;anchor.href=data.results[a].url;anchor.target="_blank";var img=document.createElement('img');img.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_THUMBNAILIMAGE;img.src=data.results[a].tbUrl;img.width=data.results[a].tbWidth;img.height=data.results[a].tbHeight;img.title=data.results[a].titleNoFormatting;anchor.appendChild(img);cell.appendChild(anchor);row.appendChild(cell);table.appendChild(row);var row=document.createElement('div');row.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_ROW;var cell=document.createElement('div');cell.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL+" "+CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL_DESCRIPTION;cell.style.setProperty("max-width",max_width+"px","important");cell.innerHTML=data.results[a].title;row.appendChild(cell);table.appendChild(row);var row=document.createElement('div');row.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_ROW;var cell=document.createElement('div');cell.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL+" "+CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL_DIMENSIONS;cell.style.setProperty("max-width",max_width+"px","important");var filenamePlusExt=GetFilename(anchor.href,true);var indexExt=filenamePlusExt.lastIndexOf('.');var ext=(indexExt==-1?"?":filenamePlusExt.substring(indexExt+1));var format=FORMAT_TIP_GOOGLEIMAGESEARCH_WIDTHHEIGHT;cell.innerText=format.replace("<<WIDTH>>",data.results[a].width).replace("<<HEIGHT>>",data.results[a].height);if(indexExt!=-1)
cell.innerText+=(" - "+ext);row.appendChild(cell);table.appendChild(row);var row=document.createElement('div');row.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_ROW;var cell=document.createElement('div');cell.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL+" "+CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL_CONTEXT;;var anchor=document.createElement('a');anchor.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CONTEXTANCHOR;anchor.href=data.results[a].originalContextUrl;anchor.target="_blank";anchor.innerText=data.results[a].visibleUrl;cell.appendChild(anchor);row.appendChild(cell);table.appendChild(row);divContentHolder.appendChild(table);}}
return styleControlObj;}
function OnSetTipPopupText_GoogleLanguageDetect(divPopup,divContentHolder,divBar,data){var styleControlObj={ttsUtterance:divPopup.request.text,ttsLang:data.codeLanguage,textAlignContent:"center",optimizeMaxWidthFor:"selection",showDisplayTitle:true,showPaging:true,lock_tip_position:false,};var srcLang=data.codeLanguage?data.codeLanguage:"auto";var destLang="auto";var href=FORMAT_TIP_GOOGLETRANSLATE_URL.replace("<<SRCLANG>>",srcLang).replace("<<DESTLANG>>",destLang).replace("<<HREF>>",location.href);var aTranslate=document.createElement('a');aTranslate.href=href;aTranslate.target="_blank";aTranslate.innerHTML=INNERHTML_TIP_GOOGLETRANSLATE_PAGE;divBar.spanDisplayTitle.appendChild(aTranslate);if(data.srcLanguageIcon){var imgIcon=document.createElement('img');imgIcon.className=CSS2.CLASS_TIP_CONTENT_ICON;imgIcon.src=data.srcLanguageIcon;imgIcon.title=data.nameLanguage;divContentHolder.appendChild(imgIcon);divContentHolder.appendChild(document.createElement('br'));}
if(data.nameLanguage){var format=FORMAT_TIP_GOOGLELANGUAGEDETECT_CONFIDENT;divContentHolder.innerHTML+=format.replace("<<LANGUAGE>>",data.nameLanguage).replace("<<CONFIDENCE>>",(data.confidence*100).toFixed(0));}
return styleControlObj;}
function OnSetTipPopupText_MSTranslateTranslate(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"center",optimizeMaxWidthFor:"selection",showDisplayTitle:true,showPaging:true,lock_tip_position:false,};var destLang=data.googleLanguageCodes&&data.googleLanguageCodes.length>1?data.googleLanguageCodes[0]:divPopup.request.tipTemplate.options.destLang;var href=FORMAT_TIP_GOOGLETRANSLATE_URL.replace("<<SRCLANG>>","auto").replace("<<DESTLANG>>",destLang).replace("<<HREF>>",location.href);styleControlObj.ttsLang=destLang;var aTranslate=document.createElement('a');aTranslate.href=href;aTranslate.target="_blank";aTranslate.innerHTML=INNERHTML_TIP_GOOGLETRANSLATE_PAGE;divBar.spanDisplayTitle.appendChild(aTranslate);if(data.urlDestLanguageIcon){var spanContainer=document.createElement('span');var format=data.nameSrcLanguage?FORMAT_TIP_GOOGLETRANSLATE_FROMTO:FORMAT_TIP_GOOGLETRANSLATE_TO;spanContainer.title=format.replace("<<FROM>>",data.nameSrcLanguage?data.nameSrcLanguage:"").replace("<<TO>>",data.nameDestLanguage);var arr=[{src:data.urlSrcLanguageIcon},{src:chrome.extension.getURL('img/arrow-000-small-cropped.png'),marginLeft:"8px",marginRight:"8px"},{src:data.urlDestLanguageIcon},];for(var e in arr){var img=document.createElement('img');img.className=CSS2.CLASS_TIP_CONTENT_ICON;img.src=arr[e].src;if(arr[e].marginLeft)
img.style.setProperty("margin-left",arr[e].marginLeft,"important");if(arr[e].marginRight)
img.style.setProperty("margin-right",arr[e].marginRight,"important");spanContainer.appendChild(img);}
divContentHolder.appendChild(spanContainer);divContentHolder.appendChild(document.createElement('br'));}
if(data.note){divContentHolder.innerHTML+=data.note;styleControlObj.ttsUtterance=data.note;}
return styleControlObj;}
function OnSetTipPopupText_GoogleTranslate(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"center",optimizeMaxWidthFor:"selection",showDisplayTitle:true,showPaging:true,lock_tip_position:false,};var srcLang=(divPopup.request.tipTemplate.options.srcLang&&divPopup.request.tipTemplate.options.srcLang!="")?divPopup.request.tipTemplate.options.srcLang:"auto";var destLang=divPopup.request.tipTemplate.options.destLang;var href=FORMAT_TIP_GOOGLETRANSLATE_URL.replace("<<SRCLANG>>",srcLang).replace("<<DESTLANG>>",destLang).replace("<<HREF>>",location.href);styleControlObj.ttsLang=destLang;var aTranslate=document.createElement('a');aTranslate.href=href;aTranslate.target="_blank";aTranslate.innerHTML=INNERHTML_TIP_GOOGLETRANSLATE_PAGE;divBar.spanDisplayTitle.appendChild(aTranslate);if(data.urlSrcLanguageIcon&&data.urlDestLanguageIcon){var spanContainer=document.createElement('span');var format=data.nameSrcLanguage?FORMAT_TIP_GOOGLETRANSLATE_FROMTO:FORMAT_TIP_GOOGLETRANSLATE_TO;spanContainer.title=format.replace("<<FROM>>",data.nameSrcLanguage).replace("<<TO>>",data.nameDestLanguage);var arr=[{src:data.urlSrcLanguageIcon},{src:chrome.extension.getURL('img/arrow-000-small-cropped.png'),marginLeft:"8px",marginRight:"8px"},{src:data.urlDestLanguageIcon},];for(var e in arr){var img=document.createElement('img');img.className=CSS2.CLASS_TIP_CONTENT_ICON;img.src=arr[e].src;if(arr[e].marginLeft)
img.style.setProperty("margin-left",arr[e].marginLeft,"important");if(arr[e].marginRight)
img.style.setProperty("margin-right",arr[e].marginRight,"important");spanContainer.appendChild(img);}
divContentHolder.appendChild(spanContainer);divContentHolder.appendChild(document.createElement('br'));}
if(data.note){divContentHolder.innerHTML+=data.note;styleControlObj.ttsUtterance=data.note;}
var divWarning=document.createElement('div');divWarning.className="warning";divWarning.innerHTML=FORMAT_TIP_GOOGLETRANSLATE_DEPRECATE;divContentHolder.appendChild(divWarning);return styleControlObj;}
function OnSetTipPopupText_GoogleTTS(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"center",optimizeMaxWidthFor:"selection",showPaging:true,lock_tip_position:false,};styleControlObj.showTemplateIcon=data.srcSpokenLanguageIcon?true:false;if(styleControlObj.showTemplateIcon==true){divBar.imgTemplateIcon.src=data.srcSpokenLanguageIcon;var format=FORMAT_TIP_MSTRANSLATE_TTS_SPOKENLANGUAGE;divBar.imgTemplateIcon.title=format.replace("<<LANGUAGE>>",data.spokenLanguageName);}
if(data.url){styleControlObj.showDisplayTitle=true;CreateBingAudioPlayer(data.url,data.urlFallback,divPopup.request.text,divBar,true,divContentHolder);}
return styleControlObj;}
function OnSetTipPopupText_YahooSpelling(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"center",optimizeMaxWidthFor:"selection",lock_tip_position:false,showPaging:true,showDisplayTitle:true,};var aSource=document.createElement('a');aSource.title=divPopup.request.text;aSource.innerText=divPopup.request.text.ellipsis(MAXCHARS_TIP_DISPLAYTITLE);divBar.spanDisplayTitle.appendChild(aSource);if(data.totalhits){var imgIcon=document.createElement('img');imgIcon.className=CSS2.CLASS_TIP_CONTENT_ICON;imgIcon.src=chrome.extension.getURL('img/'+(data.totalhits==0?'tick':'cross')+'-circle.png');divContentHolder.appendChild(imgIcon);divContentHolder.appendChild(document.createElement('br'));}
if(data.html||data.totalhits==0){divContentHolder.innerHTML+=(data.totalhits==0?FORMAT_TIP_YAHOOSPELLING_CORRECT:FORMAT_TIP_YAHOOSPELLING_SUGGESTIONS.replace("<<SUGGESTIONS>>",data.html));if(data.html)
styleControlObj.ttsUtterance=data.html;}
return styleControlObj;}
function OnSetTipPopupText_Flickr(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"left",optimizeMaxWidthFor:"default",showPaging:true,lock_tip_position:true,};if(data.pages>1){function OnClick(e){e.preventDefault();if(e.currentTarget.disabled==true)
return;var divPopup=e.currentTarget.divPopup;divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");divPopup.request.tipTemplate.sessionData.page=e.currentTarget.pageNew;chrome.extension.sendRequest(divPopup.request);}
AddPagingElements(divPopup,divBar.spanPaging,data.page,data.pages,OnClick);}
function OnChangeFlickrSort(e){if(e.type=="keyup"&&e.currentTarget.lastSelectedIndex==e.currentTarget.selectedIndex)
return;e.currentTarget.lastSelectedIndex=e.currentTarget.selectedIndex;var divPopup=e.currentTarget.divPopup;divPopup.divMain.divBar.imgWaiting.style.setProperty("visibility","visible","important");divPopup.request.tipTemplate.options.sort=e.currentTarget.value;divPopup.request.tipTemplate.sessionData.page=1;chrome.extension.sendRequest(divPopup.request);}
var selectSort=divBar.spanPaging.selectSort=document.createElement('select');selectSort.className=CSS2.CLASS_TIP_BAR_SELECT;selectSort.divPopup=divPopup;selectSort.id=RandomString(8);selectSort.addEventListener("change",OnChangeFlickrSort,false);selectSort.addEventListener("keyup",OnChangeFlickrSort,false);var labelSort=document.createElement('label');labelSort.className=CSS2.CLASS_TIP_BAR_LEFTLABEL;labelSort.htmlFor=selectSort.id;labelSort.innerHTML=INNERHTML_TIP_FLICKR_SORT;var arr=[{name:"Relevance",value:"relevance"},{name:"Date Posted (Desc)",value:"date-posted-desc"},{name:"Date Posted (Asc)",value:"date-posted-asc"},{name:"Date Taken (Desc)",value:"date-taken-desc"},{name:"Date Taken (Asc)",value:"date-taken-asc"},{name:"Interestingness (Desc)",value:"interestingness-desc"},{name:"Interestingness (Asc)",value:"interestingness-asc"}];for(var p in arr)
selectSort.options.add(new Option(arr[p].name,arr[p].value));selectSort.value=divPopup.request.tipTemplate.options.sort;divBar.spanPaging.appendChild(labelSort);divBar.spanPaging.appendChild(selectSort);if(data.photos){var max_width=max_height=0;for(var a in data.photos){if(data.photos[a].thumbnail.width>max_width)
max_width=data.photos[a].thumbnail.width;if(data.photos[a].thumbnail.height>max_height)
max_height=data.photos[a].thumbnail.height;}
for(var a in data.photos){var table=document.createElement('div');table.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT;table.style.setProperty("width",max_width+"px","important");var row=document.createElement('div');row.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_ROW;var cell=document.createElement('div');cell.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL+" "+CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL_THUMBNAIL;var anchor=document.createElement('a');anchor.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_THUMBNAILANCHOR;anchor.href=data.photos[a].hrefPhoto;anchor.target="_blank";var img=document.createElement('img');img.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_THUMBNAILIMAGE;img.src=data.photos[a].thumbnail.src;img.width=data.photos[a].thumbnail.width;img.height=data.photos[a].thumbnail.height;img.title=data.photos[a].title;anchor.appendChild(img);cell.appendChild(anchor);row.appendChild(cell);table.appendChild(row);var row=document.createElement('div');row.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_ROW;var cell=document.createElement('div');cell.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL+" "+CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL_DESCRIPTION;cell.innerHTML=data.photos[a].title.ellipsis(MAXCHARS_TIP_FLICKR_TITLE);row.appendChild(cell);table.appendChild(row);var innerHTML="";if(data.photos[a].originalimage&&data.photos[a].originalimage.width&&data.photos[a].originalimage.height)
innerHTML+=FORMAT_TIP_GOOGLEIMAGESEARCH_WIDTHHEIGHT.replace("<<WIDTH>>",data.photos[a].originalimage.width).replace("<<HEIGHT>>",data.photos[a].originalimage.height);if(data.photos[a].originalformat)
innerHTML+=((innerHTML.length>0?" - ":"")+data.photos[a].originalformat);if(data.photos[a].datetaken)
innerHTML+=((innerHTML.length>0?"<br/>":"")+TimeAgo(new Date(data.photos[a].datetaken),{years:true,days:true,today:true}));if(innerHTML.length>0){var row=document.createElement('div');row.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_ROW;var cell=document.createElement('div');cell.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL+" "+CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL_DIMENSIONS;cell.innerHTML=innerHTML;if(data.photos[a].originalimage&&data.photos[a].originalimage.src){var aOrig=document.createElement("a");aOrig.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_ORIGINALFILEANCHOR;aOrig.href=data.photos[a].originalimage.src;aOrig.title=TOOLTIP_TIP_FLICKR_ORIGINAL;aOrig.target="_blank";aOrig.innerHTML=INNERHTML_TIP_FLICKR_ORIGINALFILE;cell.appendChild(aOrig);}
row.appendChild(cell);table.appendChild(row);}
var row=document.createElement('div');row.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_ROW;var cell=document.createElement('div');cell.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL+" "+CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CELL_CONTEXT;var anchor=document.createElement('a');anchor.className=CSS2.CLASS_TIP_CONTENT_IMAGERESULT_CONTEXTANCHOR;anchor.href=data.photos[a].hrefProfile;anchor.target="_blank";anchor.innerText=data.photos[a].ownername;cell.appendChild(anchor);row.appendChild(cell);table.appendChild(row);divContentHolder.appendChild(table);}}
return styleControlObj;}
function OnSetTipPopupText_MSTranslateTTS(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"center",optimizeMaxWidthFor:"selection",showPaging:true,lock_tip_position:false,};styleControlObj.showTemplateIcon=data.srcSpokenLanguageIcon?true:false;if(styleControlObj.showTemplateIcon==true){divBar.imgTemplateIcon.src=data.srcSpokenLanguageIcon;var format=FORMAT_TIP_MSTRANSLATE_TTS_SPOKENLANGUAGE;divBar.imgTemplateIcon.title=format.replace("<<LANGUAGE>>",data.spokenLanguageName);}
if(data.url){styleControlObj.showDisplayTitle=true;CreateBingAudioPlayer(data.url,null,divPopup.request.text,divBar,BUG_68135_NOCACHE,divContentHolder);}
return styleControlObj;}
function OnSetTipPopupText_WikiMedia(divPopup,divContentHolder,divBar,data){var styleControlObj={textAlignContent:"left",optimizeMaxWidthFor:"default",lock_tip_position:false,showPaging:true,};divPopup.request.tipTemplate.sessionData.hrefWikiPage=data.hrefWikiPage;divPopup.request.tipTemplate.sessionData.hashWikiPage=data.hashWikiPage;styleControlObj.showTemplateIcon=data.srcEditionFlagIcon?true:false;if(styleControlObj.showTemplateIcon==true){divBar.imgTemplateIcon.src=data.srcEditionFlagIcon;divBar.imgTemplateIcon.title=data.tooltipEditionFlag;}
var arrNoticeBar=[{srcImage:"img/direction.png",title:"Disambiguation & Redirection",key:"NB",defaultShow:true},{srcImage:"img/chart_organisation.png",title:"Related Pages",key:"furtherreading"},{srcImage:"img/category.png",title:"Categories",key:"categories"},{srcImage:"img/external.png",title:"External Links",key:"externallinks"},{srcImage:"img/globe.png",title:"Languages",key:"langlinks"},];var arrNoticeBarItem=[{html:data.htmlAutoRedirects,keyNoticeBar:"NB"},{html:data.htmlRedirects,keyNoticeBar:"NB"},{html:data.htmlDisambigs,srcImage:"img/disambiguation.png",keyNoticeBar:"NB"},{html:data.htmlSeeAlsos,keyNoticeBar:"furtherreading"},{html:data.htmlMainArticles,keyNoticeBar:"furtherreading"},{html:data.htmlCategories,keyNoticeBar:"categories"},{html:data.htmlExternalLinks,keyNoticeBar:"externallinks"},{html:data.htmlLanguages,keyNoticeBar:"langlinks"},];for(var q in arrNoticeBarItem){if(arrNoticeBarItem[q].html==null||arrNoticeBarItem[q].html=="")
continue;for(var x in arrNoticeBar){if(arrNoticeBar[x].key!=arrNoticeBarItem[q].keyNoticeBar)
continue;styleControlObj.showNoticeButtons=true;if(arrNoticeBar[x].id==null){arrNoticeBar[x].id=AddNoticeBar(divPopup,arrNoticeBar[x].key,chrome.extension.getURL(arrNoticeBar[x].srcImage),arrNoticeBar[x].title);var show;show=buttonStatusTipPopupNoticeBar[arrNoticeBar[x].key]!=null?buttonStatusTipPopupNoticeBar[arrNoticeBar[x].key]:arrNoticeBar[x].defaultShow;ShowNoticeBar(divPopup,arrNoticeBar[x].id,show);}
var htmlNoticeBarContent="";if(arrNoticeBarItem[q].srcImage){var img=document.createElement('img');img.src=chrome.extension.getURL(arrNoticeBarItem[q].srcImage);htmlNoticeBarContent+=img.outerHTML;}
htmlNoticeBarContent+=arrNoticeBarItem[q].html;SetNoticeBarContent(divPopup,arrNoticeBar[x].id,htmlNoticeBarContent);break;}}
if(data.displaytitle){styleControlObj.showDisplayTitle=true;var aDisplayTitle=document.createElement('a');aDisplayTitle.target="_blank";aDisplayTitle.href=data.hrefWikiPage;aDisplayTitle.title=html_sanitize(data.displaytitle);aDisplayTitle.innerHTML=html_sanitize(data.displaytitle.ellipsis(MAXCHARS_TIP_DISPLAYTITLE));divBar.spanDisplayTitle.appendChild(aDisplayTitle);}
var spanIntro=null;if(data.htmlIntro&&data.htmlIntro.length>0){spanIntro=document.createElement('div');spanIntro.id=RandomString(8);spanIntro.className=CSS2.CLASS_TIP_CONTENT_MEDIAWIKI_LEVEL2SECTION;if(data.arrImageOuterHTML){for(var a in data.arrImageOuterHTML){var span=document.createElement('span');span.className=CSS2.CLASS_TIP_CONTENT_MEDIAWIKI_FLOATING;span.innerHTML=data.arrImageOuterHTML[a];spanIntro.innerHTML+=span.outerHTML;}}
spanIntro.innerHTML+=data.htmlIntro;divContentHolder.appendChild(spanIntro);}
if(divPopup.request.tipTemplate.options.getSections==true&&data.sections&&data.sections.length>0){divContentHolder.innerHTML+=data.html;var selectSection=divBar.spanPaging.selectSection=document.createElement('select');selectSection.className=CSS2.CLASS_TIP_BAR_SELECT;selectSection.style.setProperty("max-width","10em","important");selectSection.style.setProperty("margin-right","2px","important");selectSection.divPopup=divPopup;selectSection.id=RandomString(8);selectSection.title=TOOLTIP_TIP_MEDIAWIKI_SECTION;selectSection.addEventListener("change",OnChangeSection_MediaWiki,false);selectSection.addEventListener("keyup",OnChangeSection_MediaWiki,false);var labelSection=document.createElement('label');labelSection.className=CSS2.CLASS_TIP_BAR_LEFTLABEL;labelSection.htmlFor=selectSection.id;labelSection.innerHTML=INNERHTML_TIP_MEDIAWIKI_SECTION;divBar.spanPaging.appendChild(labelSection);divBar.spanPaging.appendChild(selectSection);if(spanIntro){var option=new Option(SECTIONNAME_TIP_MEDIAWIKI_INTRO,spanIntro.id);option.idLevel2Section=spanIntro.id;option.lineUndecorated=SECTIONNAME_TIP_MEDIAWIKI_INTRO;selectSection.options.add(option);}
var idLevel2Section;var numLevel2Sections=0;var levelLowest=data.sections.length>0?data.sections[0].level:null;for(var x in data.sections){if(data.sections[x].level==levelLowest){idLevel2Section=data.sections[x].anchor;numLevel2Sections++;}
var option=new Option(html_sanitize((data.sections[x].level>levelLowest?"\u00a0":"")+data.sections[x].number+" "+data.sections[x].line),html_sanitize(data.sections[x].anchor));option.idLevel2Section=idLevel2Section;option.lineUndecorated=data.sections[x].line;selectSection.options.add(option);}
if(data.hashWikiPage){styleControlObj.showSection={idSection:null,idScroll:data.hashWikiPage,classNameSection:CSS2.CLASS_TIP_CONTENT_MEDIAWIKI_LEVEL2SECTION,};}
else{if(selectSection.options.length>=1){var idSection=null;if(divPopup.request.tipTemplate.options.rememberLastSection==true&&divPopup.request.tipTemplate.options.idLastSection)
idSection=divPopup.request.tipTemplate.options.idLastSection;if(idSection==null){if(divPopup.request.tipTemplate.options.defaultSection&&divPopup.request.tipTemplate.options.defaultSection.length>0){for(var w=0;w<selectSection.options.length;w++){if(selectSection.options[w].lineUndecorated.toLowerCase()==divPopup.request.tipTemplate.options.defaultSection.toLowerCase()){idSection=selectSection.options[w].idLevel2Section;break;}}}
if(idSection==null)
idSection=selectSection.options[0].idLevel2Section;}
styleControlObj.showSection={idSection:idSection,idSectionFallback:selectSection.options[0].idLevel2Section,idScroll:null,classNameSection:CSS2.CLASS_TIP_CONTENT_MEDIAWIKI_LEVEL2SECTION,};}}
if(selectSection.options.length==1)
selectSection.style.setProperty("font-style","italic","important");var arrUpDown=[{srcImage:'img/navigation-270-button.png',title:TOOLTIP_TIP_MEDIAWIKI_SECTION_DOWN,sectionOffset:1},{srcImage:'img/navigation-090-button.png',title:TOOLTIP_TIP_MEDIAWIKI_SECTION_UP,sectionOffset:-1},];var spanUpDownContainer=selectSection.spanUpDownContainer=document.createElement('span');spanUpDownContainer.className=CSS2.CLASS_TIP_BAR_BUTTONCONTAINER;spanUpDownContainer.style.setProperty("margin-right","6px","important");for(var a in arrUpDown){var anchor=document.createElement('a');anchor.className=CSS2.CLASS_TIP_BAR_BUTTON;anchor.href="#";anchor.title=arrUpDown[a].title;var img=anchor.img=document.createElement('img');img.src=chrome.extension.getURL(arrUpDown[a].srcImage);img.className=CSS2.CLASS_TIP_BAR_BUTTONIMAGE;anchor.appendChild(img);anchor.selectSection=selectSection;anchor.sectionOffset=arrUpDown[a].sectionOffset;anchor.spanUpDownContainer=spanUpDownContainer;anchor.addEventListener("click",function(e){e.preventDefault();var anchor=e.currentTarget;var selectSection=anchor.selectSection;if(e.shiftKey==true){var indexNew=selectSection.selectedIndex+anchor.sectionOffset;if(indexNew<0||indexNew>=selectSection.options.length)
return;selectSection.selectedIndex=indexNew;}
else{if(anchor.disabled==true)
return;selectSection.value=anchor.idLevel2SectionGoto;}
OnChangeSection_MediaWiki({currentTarget:selectSection});UpdateUpDownButtons_MediaWiki(anchor.spanUpDownContainer,selectSection);},true);spanUpDownContainer.appendChild(anchor);}
UpdateUpDownButtons_MediaWiki(spanUpDownContainer,selectSection);divBar.spanPaging.appendChild(spanUpDownContainer);}
if(data.arrInfoboxOuterHTML&&data.arrInfoboxOuterHTML.length>0){var spanInfoboxContainer=document.createElement('span');spanInfoboxContainer.className=CSS2.CLASS_TIP_CONTENT_MEDIAWIKI_INFOBOXCONTAINER;spanInfoboxContainer.id=RandomString(8);spanInfoboxContainer.title=TOOLTIP_TIP_MEDIAWIKI_INFOBOXCONTAINER;for(var a in data.arrInfoboxOuterHTML)
spanInfoboxContainer.innerHTML+=data.arrInfoboxOuterHTML[a];var anchorButton=divPopup.anchorButtonInfoBox=document.createElement('a');anchorButton.className=CSS2.CLASS_TIP_BAR_BUTTON;anchorButton.style.setProperty("padding-right","6px","important");anchorButton.href="#";anchorButton.title=TOOLTIP_TIP_MEDIAWIKI_INFOBOX;var img=anchorButton.img=document.createElement('img');img.src=chrome.extension.getURL("img/infocard.png");img.className=CSS2.CLASS_TIP_BAR_BUTTONIMAGE;anchorButton.appendChild(img);anchorButton.divPopup=divPopup;anchorButton.keyPersist="infobox";anchorButton.idInfoboxContainer=spanInfoboxContainer.id;anchorButton.selected=buttonStatusTipPopupNoticeBar[anchorButton.keyPersist]==null?false:buttonStatusTipPopupNoticeBar[anchorButton.keyPersist];anchorButton.addEventListener("click",OnClickButtonInfobox_MediaWiki,true);OnClickButtonInfobox_MediaWiki({currentTarget:anchorButton},anchorButton.selected);styleControlObj.level2SectionTagName=(anchorButton.selected==true?"span":"div");spanInfoboxContainer.style.setProperty("display",anchorButton.selected==true?"":"none","important");divBar.spanPaging.appendChild(anchorButton);divContentHolder.insertAdjacentElement("afterBegin",spanInfoboxContainer);}
else
divPopup.anchorButtonInfoBox=null;return styleControlObj;}
function OnClickButtonInfobox_MediaWiki(e,show){e.returnValue=false;if(show==null)
show=e.currentTarget.selected==true?false:true;e.currentTarget.selected=show;e.currentTarget.img.className=CSS2.CLASS_TIP_BAR_BUTTONIMAGE;if(e.currentTarget.selected==true)
e.currentTarget.img.classList.add(CSS2.CLASS_TIP_BAR_BUTTONSELECTED_X);buttonStatusTipPopupNoticeBar[e.currentTarget.keyPersist]=e.currentTarget.selected;chrome.extension.sendRequest({msg:"relayRequest",msgRelay:MSG_TIP_CONTENT_SETLEVEL2SECTIONTAGNAMES,tipId:e.currentTarget.divPopup.id,tagName:show==true?"span":"div"});chrome.extension.sendRequest({msg:"relayRequest",msgRelay:MSG_TIP_CONTENT_SHOWSECTION,tipId:e.currentTarget.divPopup.id,idSection:e.currentTarget.idInfoboxContainer,idScroll:null,classNameSection:null,show:e.currentTarget.selected});}
function OnChangeSection_MediaWiki(e,idScrollOverride){if(e.type=="keyup"&&e.currentTarget.lastSelectedIndex==e.currentTarget.selectedIndex)
return;e.currentTarget.lastSelectedIndex=e.currentTarget.selectedIndex;var option=e.currentTarget.options[e.currentTarget.selectedIndex];ShowSection_MediaWiki(e.currentTarget.divPopup.id,option.idLevel2Section,idScrollOverride?idScrollOverride:option.value);if(e.currentTarget.spanUpDownContainer)
UpdateUpDownButtons_MediaWiki(e.currentTarget.spanUpDownContainer,e.currentTarget);}
function ShowSection_MediaWiki(tipId,idSection,idScroll){var divPopup=document.getElementById(tipId);if(divPopup){if(divPopup.anchorButtonInfoBox&&divPopup.anchorButtonInfoBox.selected==true){PositionTipPopup(divPopup,{dimensionsIFrameBody:{remove_width:false,remove_height:true,}});}}
chrome.extension.sendRequest({msg:"relayRequest",msgRelay:MSG_TIP_CONTENT_SHOWSECTION,tipId:tipId,idSection:idSection,idScroll:idScroll,classNameSection:CSS2.CLASS_TIP_CONTENT_MEDIAWIKI_LEVEL2SECTION,callbackData:{tipId:tipId,idSection:idSection,},},function(reply){var divPopup=document.getElementById(reply.callbackData.tipId);if(divPopup){if(divPopup.request.tipTemplate.options.rememberLastSection==true)
divPopup.request.tipTemplate.options.idLastSection=reply.callbackData.idSection;}});}
function OnSizeChangeIFrame(request){var divPopup=document.getElementById(request.tipId);if(divPopup==null)
return;var height=(divPopup.anchorButtonInfoBox&&divPopup.anchorButtonInfoBox.selected==true)?request.scrollHeight+PADDING_HEIGHT_WITH_INFOBOXCONTAINER:request.offsetHeight;PositionTipPopup(divPopup,{set_origin:false,dimensionsIFrameBody:{remove_width:false,height:height,}});}
function UpdateUpDownButtons_MediaWiki(spanUpDownContainer,selectSection){var anchors=spanUpDownContainer.getElementsByTagName('A');for(var a=0;a<anchors.length;a++){var idLevel2SectionSelected=selectSection.options[selectSection.selectedIndex].idLevel2Section;anchors[a].disabled=true;for(var i=selectSection.selectedIndex+anchors[a].sectionOffset;i>=0&&i<selectSection.options.length;i+=anchors[a].sectionOffset){if(selectSection.options[i].idLevel2Section!=idLevel2SectionSelected){anchors[a].disabled=false;anchors[a].idLevel2SectionGoto=selectSection.options[i].idLevel2Section;break;}}
anchors[a].style.setProperty("opacity",anchors[a].disabled==true?OPACITY_BUTTON_DISABLED:OPACITY_BUTTON_ENABLED,"important");}}
function AddPagingElements(divPopup,elemParent,page,pages,OnClick,opt){var spanContainer=document.createElement('span');spanContainer.className=CSS2.CLASS_TIP_BAR_BUTTONCONTAINER;spanContainer.style.setProperty("margin-right","3px","important");var arrPaging=[{srcImage:'img/navigation-180-button.png',title:TOOLTIP_TIP_PAGE_PREVIOUS,pageOffset:-1,enabled:page>1},{srcImage:'img/navigation-000-button.png',title:TOOLTIP_TIP_PAGE_NEXT,pageOffset:1,enabled:page<pages},];for(var a in arrPaging){var aPage=document.createElement('a');aPage.className=CSS2.CLASS_TIP_BAR_BUTTON;if(arrPaging[a].marginLeft)
aPage.style.setProperty("margin-left",arrPaging[a].marginLeft,"important");if(arrPaging[a].marginRight)
aPage.style.setProperty("margin-right",arrPaging[a].marginRight,"important");aPage.href="#";aPage.title=arrPaging[a].title;var imgPage=aPage.img=document.createElement('img');imgPage.src=chrome.extension.getURL(arrPaging[a].srcImage);imgPage.className=CSS2.CLASS_TIP_BAR_BUTTONIMAGE;aPage.appendChild(imgPage);aPage.disabled=(arrPaging[a].enabled==true?false:true);aPage.style.setProperty("opacity",arrPaging[a].enabled==true?OPACITY_BUTTON_ENABLED:OPACITY_BUTTON_DISABLED,"important");aPage.pageNew=page+(arrPaging[a].pageOffset);aPage.divPopup=divPopup;aPage.addEventListener("click",OnClick,true);spanContainer.appendChild(aPage);}
elemParent.appendChild(spanContainer);var format;if(opt&&opt.unknownTotalPages==true)
format=FORMAT_TIP_PAGE.replace("<<PAGE>>",AddCommas(page));else
format=FORMAT_TIP_PAGEOFPAGES.replace("<<PAGE>>",AddCommas(page)).replace("<<TOTALPAGES>>",AddCommas(pages));var spanText=document.createElement('span');spanText.className=CSS2.CLASS_TIP_BAR_TEXT;spanText.style.setProperty("margin-right","6px","important");spanText.innerHTML=format;elemParent.appendChild(spanText);}
function GetTipTemplateFromDOMAndMasterTemplate(templateId){var template=null;var masterTemplate=null;if(templateId==null)
return null;for(var y in _arrTipPopupMasterTemplates){if(_arrTipPopupMasterTemplates[y].id==templateId){masterTemplate=_arrTipPopupMasterTemplates[y];for(var x in arrTipPopupTemplates){if(arrTipPopupTemplates[x].id==masterTemplate.id){template=arrTipPopupTemplates[x];break;}}
break;}}
if(masterTemplate==null)
return null;if(template==null){template=_clone(masterTemplate);template.options=_clone(masterTemplate.defaultOptions);arrTipPopupTemplates.push(template);}
else{if(template.options==null)
template.options={};for(var q in masterTemplate.defaultOptions){if(template.options[q]===undefined)
template.options[q]=masterTemplate.defaultOptions[q];}}
if(CSS2.CLASS_TIP_CONTENT_MEDIAWIKI_LEVEL2SECTION===undefined)
CSS2.BuildStyleSheet("tip",CSSID_MEDIAWIKI);template.sessionData={hostname:location.hostname,isSourceCursorChange:false,classNameL2SectionMediaWiki:CSS2.CLASS_TIP_CONTENT_MEDIAWIKI_LEVEL2SECTION,};return({masterTemplate:masterTemplate,template:template});}
function CreateBingAudioPlayer(url,urlFallback,displayTitle,divBar,bug68135NoCache,divContentHolder){var aSource=document.createElement('a');aSource.href=url;aSource.target="_blank";aSource.title=displayTitle;aSource.innerText=displayTitle.ellipsis(MAXCHARS_TIP_DISPLAYTITLE);divBar.spanDisplayTitle.appendChild(aSource);var button=document.createElement('button');if(bug68135NoCache==true)
button.setAttribute("bug68135NoCache",bug68135NoCache);button.className=CLASS_BING_BUTTONAUDIOPLAYER;button.style.setProperty("-webkit-user-select","none","important");button.title=TOOLTIP_TIP_MSTRANSLATE_TTS_PLAY;if(urlFallback)
button.setAttribute("srcaudiofallback",urlFallback);button.setAttribute("srcaudio",url);var img=document.createElement('img')
img.src=chrome.extension.getURL("img/speaker-volume-low2.png");button.appendChild(img);var audio=document.createElement('audio');audio.id=RandomString(32);audio.controls=false;audio.preload="none";button.appendChild(audio);divContentHolder.appendChild(button);}
function AddNoticeBar(divPopup,keyPersist,srcImage,title){var anchorNoticeBarButton=document.createElement('a');anchorNoticeBarButton.className=CSS2.CLASS_TIP_BAR_BUTTON;anchorNoticeBarButton.style.setProperty("padding-left","3px","important");anchorNoticeBarButton.href="#";anchorNoticeBarButton.title=title;var img=anchorNoticeBarButton.img=document.createElement('img');img.src=srcImage
img.className=CSS2.CLASS_TIP_BAR_BUTTONIMAGE;anchorNoticeBarButton.appendChild(img);anchorNoticeBarButton.divPopup=divPopup;anchorNoticeBarButton.selected=false;anchorNoticeBarButton.keyPersist=keyPersist;anchorNoticeBarButton.id=RandomString(8);anchorNoticeBarButton.addEventListener("click",function(e){e.currentTarget.selected=(e.currentTarget.selected==true?false:true);ShowNoticeBar(e.currentTarget.divPopup,e.currentTarget.id,e.currentTarget.selected);e.preventDefault();},true);divPopup.divMain.divBar.spanNoticeButtons.appendChild(anchorNoticeBarButton);return anchorNoticeBarButton.id;}
function RemoveAllNoticeBars(divPopup){var anchors=divPopup.divMain.divBar.spanNoticeButtons.getElementsByTagName("A");for(var q=anchors.length-1;q>=0;q--)
RemoveNoticeBar(divPopup,anchors[q].id);}
function RemoveNoticeBar(divPopup,idNoticeBarButton){var anchorNoticeBarButton=document.getElementById(idNoticeBarButton);if(anchorNoticeBarButton==null)
return;var elems=divPopup.divMain.divNoticeBars.getElementsByClassName(idNoticeBarButton);for(var q=elems.length-1;q>=0;q--)
elems[q].parentNode.removeChild(elems[q]);anchorNoticeBarButton.parentNode.removeChild(anchorNoticeBarButton);}
function ShowNoticeBar(divPopup,idNoticeBarButton,show){var anchorNoticeBarButton=document.getElementById(idNoticeBarButton);if(anchorNoticeBarButton==null)
return;anchorNoticeBarButton.img.className=CSS2.CLASS_TIP_BAR_BUTTONIMAGE;if(show==true)
anchorNoticeBarButton.img.classList.add(CSS2.CLASS_TIP_BAR_BUTTONSELECTED_X);anchorNoticeBarButton.selected=show;buttonStatusTipPopupNoticeBar[anchorNoticeBarButton.keyPersist]=show;var elems=divPopup.divMain.divNoticeBars.getElementsByClassName(idNoticeBarButton);for(var q=0;q<elems.length;q++)
elems[q].style.setProperty("display",show==true?"":"none","important");}
function SetNoticeBarContent(divPopup,idNoticeBarButton,innerHTML){var divNoticeBar=document.createElement('div');divNoticeBar.className=CSS2.CLASS_TIP_NOTICEBAR+" "+idNoticeBarButton;divNoticeBar.innerHTML=html_sanitize(innerHTML,function(uri){return uri;},function(nm,atype){return(atype==html4.atype.FRAME_TARGET?nm:null);});divPopup.divMain.divNoticeBars.appendChild(divNoticeBar);var anchorNoticeBarButton=document.getElementById(idNoticeBarButton);if(anchorNoticeBarButton)
divNoticeBar.style.setProperty("display",anchorNoticeBarButton.selected==true?"":"none","important");}
function GetTipTemplateClone(templateId){var template=GetPreference(templateId);if(template==null){for(var y in _arrTipPopupMasterTemplates){if(_arrTipPopupMasterTemplates[y].id==templateId){template=_arrTipPopupMasterTemplates[y];break;}}}
if(template){template=_clone(template);if(template.options==null)
template.options={};for(var q in template.defaultOptions){if(template.options[q]===undefined)
template.options[q]=template.defaultOptions[q];}}
return template;}